openapi: 3.0.0
info:
  title: Intelligent Retrieval Agent API
  description: API for the OpenRouter-based retrieval agent that answers questions from document collections
  version: 1.0.0
servers:
  - url: http://localhost:8000
    description: Development server
paths:
  /query:
    post:
      summary: Submit a natural language query to the retrieval agent
      description: Processes a user query, retrieves relevant document chunks, and generates a grounded response
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - query
              properties:
                query:
                  type: string
                  description: Natural language question from the user
                  example: "What are the key principles of humanoid robotics?"
                document_collection:
                  type: string
                  description: Optional identifier for a specific document collection
                  example: "robotics_handbook"
                max_chunks:
                  type: integer
                  description: Maximum number of document chunks to retrieve
                  default: 5
                  minimum: 1
                  maximum: 20
      responses:
        '200':
          description: Successful response with answer and source information
          content:
            application/json:
              schema:
                type: object
                required:
                  - response
                  - source_chunks
                  - grounded
                properties:
                  response:
                    type: string
                    description: Natural language answer generated by the agent
                    example: "The key principles of humanoid robotics include..."
                  source_chunks:
                    type: array
                    items:
                      type: object
                      properties:
                        chunk_id:
                          type: string
                          description: Unique identifier of the document chunk
                        content:
                          type: string
                          description: Content of the retrieved chunk
                        relevance_score:
                          type: number
                          format: float
                          description: Relevance score of the chunk to the query
                        source_document:
                          type: string
                          description: Name or identifier of the source document
                  grounded:
                    type: boolean
                    description: Whether the response is grounded in the retrieved context
                  query_id:
                    type: string
                    description: Unique identifier for the query
                  confidence:
                    type: number
                    format: float
                    description: Confidence score in the response accuracy
        '400':
          description: Bad request - invalid query or parameters
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Query is required and cannot be empty"
        '500':
          description: Internal server error - retrieval or generation failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    description: Error message
                    example: "Failed to retrieve documents from the vector database"
components:
  schemas:
    QueryRequest:
      type: object
      required:
        - query
      properties:
        query:
          type: string
          description: Natural language question from the user
        document_collection:
          type: string
          description: Optional identifier for a specific document collection
        max_chunks:
          type: integer
          description: Maximum number of document chunks to retrieve
          default: 5
    QueryResponse:
      type: object
      required:
        - response
        - source_chunks
        - grounded
      properties:
        response:
          type: string
          description: Natural language answer generated by the agent
        source_chunks:
          type: array
          items:
            $ref: '#/components/schemas/SourceChunk'
        grounded:
          type: boolean
          description: Whether the response is grounded in the retrieved context
        query_id:
          type: string
          description: Unique identifier for the query
        confidence:
          type: number
          format: float
          description: Confidence score in the response accuracy
    SourceChunk:
      type: object
      properties:
        chunk_id:
          type: string
          description: Unique identifier of the document chunk
        content:
          type: string
          description: Content of the retrieved chunk
        relevance_score:
          type: number
          format: float
          description: Relevance score of the chunk to the query
        source_document:
          type: string
          description: Name or identifier of the source document